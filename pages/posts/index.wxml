<wxs module="helper">
  var unescape = function(text) {
    return text.split(getRegExp('&.*?;', 'gi')).join('')
  }
  var timer = function(text) {
    return text.split('T')[0]
  }
  module.exports.unescape = unescape
  module.exports.timer = timer
</wxs>

<scroll-view
  scroll-y
  scroll-with-animation
  enable-back-to-top
  bindscrolltolower="onScrollBottom"
  bindscroll="onScroll"
  scroll-top="{{scrollTop}}"
>
  <navigator
    wx:for="{{posts}}"
    wx:key="index"
    class="post"
    url="/pages/post/index?id={{item.id}}"
  >
    <view class="cover">
      <image mode="widthFix" src="{{item.thumbnail}}" />
      <text class="title">{{item.title.rendered}}</text>
    </view>
    <text class="time">{{helper.timer(item.date)}}</text>
    <view class="excerpt">
      <rich-text nodes="{{helper.unescape(item.excerpt.rendered)}}" />
    </view>
  </navigator>
</scroll-view>
